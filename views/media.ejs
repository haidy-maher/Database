<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <!-- CSS LINK -->
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/tables.css">

    <!-- Font awesome -->
    <script src="https://kit.fontawesome.com/6b11d4a153.js" crossorigin="anonymous"></script>
    <!-- Font -->
    <!-- FONT 1 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Grandiflora+One&family=Rethink+Sans:ital,wght@0,400;0,500;0,600;0,700;0,800;1,400;1,500;1,600;1,700;1,800&family=Silkscreen&display=swap"
        rel="stylesheet">
</head>

<style>
    tr td img {
        width: 150px;
    }

    .view-icon
    {
        color: #284e7d;
    }
</style>

<body>


    <%- include('dashboardNav.ejs') %>



        <!-- Main -->
        <div class="main">
            <div class="header">
                <div class="title">
                    <h3>Media</h3>
                </div>
                <div class="button">
                    <p><a href="/addMedia">Upload<span><i class="fa-solid fa-plus"></i></span></a></p>
                </div>
            </div>
            <div class="content">



                <table>
                    <thead id="header">
                        <tr>
                            <th scope="col">Media</th>
                            <th scope="col">Description</th>
                            <th scope="col">Date</th>
                            <th scope="col">View</th>
                            <th scope="col">Edit</th>
                            <th scope="col">Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><img src="images/logo.png" alt=""></td>
                            <td> Lorem ipsum dolor sit amet.</td>
                            <td>12/12/2012</td>
     
                           
                            <td data-label="View"> <a href="#" class="view-icon"> <i class="fa-solid fa-eye"></i></a>  </td>
        

                            <td data-label="Edit"><a href="#"><i class="fa-solid fa-pen-to-square edit-icon"></i></a></td>

                            <td data-label="Delete"><a href="#" class="delete-icon"><i class="fa-solid fa-trash-can delete-icon"></i></a></td>

                        </tr>

                    </tbody>
                </table>




            </div>

        </div>
        <script>
            // Function to handle session deletion
            function deleteSession(sessionId) {
                fetch(`/deleteSession/${sessionId}`, {
                    method: 'DELETE',
                })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log('Session deleted:', data);
                        // Remove the deleted session row from the table without reloading the page
                        const deletedRow = document.querySelector(`[data-session-id="${sessionId}"]`).closest('tr');
                        deletedRow.remove();
                    })
                    .catch(error => {
                        console.error('Error deleting session:', error);
                        // Handle error, show an error message, or perform necessary actions
                    });
            }

            // Event listener to handle click on delete icon
            document.addEventListener('click', function (event) {
                if (event.target.classList.contains('delete-icon')) {
                    event.preventDefault(); // Prevent default behavior of the link
                    const sessionId = event.target.closest('tr').querySelector('.delete-icon').dataset.sessionId;
                    if (confirm('Are you sure you want to delete this session?')) {
                        deleteSession(sessionId); // Call deleteSession function with the session ID
                    }
                }
            });
        </script>


</body>

</html>